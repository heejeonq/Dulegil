<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="adNotice">


	<!-- 목록 -->
	<select id="list" resultType="hashmap">
		SELECT A.POST_NO, A.TITLE, A.NM, A.REG_DT,A.RNK
		FROM(	SELECT N.POST_NO, N.TITLE, N.CONTENTS, M.NM, N.REG_DT,
					ROW_NUMBER()OVER(ORDER BY N.REG_DT DESC) AS RNK 
				FROM NOTICE N INNER JOIN MEMBER M
              					  ON N.MEMBER_NO = M.MEMBER_NO
				WHERE N.DEL_DT IS NULL) A
		WHERE A.RNK BETWEEN #{start} AND #{end}
		<if test="searchTxt != null and searchTxt !='' ">
			<choose>
				<when test="searchGbn == 0">
					AND TITLE LIKE '%' || #{searchTxt} || '%'
				</when>
				<when test="searchGbn == 1">
					AND CONTENTS LIKE '%' || #{searchTxt} || '%'
				</when>
			</choose>
		</if>
	</select>

	<!-- 페이징 -->
	<select id="cnt" parameterType="hashmap" resultType="integer">
		SELECT COUNT(*) AS CNT
		FROM NOTICE
		WHERE DEL_DT IS NULL
		<if test="searchTxt != null and searchTxt !='' ">
			<choose>
				<when test="searchGbn == 0">
					AND TITLE LIKE '%' || #{searchTxt} || '%'
				</when>
				<when test="searchGbn == 1">
					AND CONTENTS LIKE '%' || #{searchTxt} || '%'

				</when>
			</choose>
		</if>
	</select>


	<!-- 작성 -->
	<insert id="insert" parameterType="hashmap">
		INSERT INTO NOTICE(POST_NO, TITLE, MEMBER_NO, CONTENTS, ATT_FILE,
		MUST_READ_YN)
		VALUES(NOTICE_SEQ.NEXTVAL, #{title}, 1, #{contents}, #{attFile}, #{mainCheck})
	</insert>


	<!-- 수정 -->
	<update id="update">
	</update>


	<!-- 삭제 -->
	<update id="delete" parameterType="hashmap">

	UPDATE NOTICE SET DEL_DT = SYSDATE
	WHERE POST_NO = #{no}

	</update>

</mapper>